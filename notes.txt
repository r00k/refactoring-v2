Dependency injection
  isn't exemplary, it's real
  isn't rails, so there's some small weirdness
  open PurchasesController
  where does km_http_client come from?
  benefits
    injecting this dependency makes testing easier
      don't need to stub out KM-related methods - good for integration
  costs
    indirection
      class variables and cattr_* are confusing
    hides implicit knowledge
  BEGIN
    open up kissmetrics_client_factory.rb and spec
    add first test for fake factory in test mode
    talk about sliming
    add test for non-test-mode, don't use fancy block
    refactor to block with ensure
    remove code from ApplicationController
    fixup tests
  benefits of new code
    still injecting dependency
    implicit is now implicitly captured
    indirection is lowered

LoD
  Show stub chains in tests
  You can't "just duplicate once"
    Story about trying to find root cause of difficulty behind a change
      
Iceberg classes
  Listen to the tests

View specs vs integration specs

Using pure mocks in views

Todo
  opening 'slide'
